\documentclass[norsk,a4paper,12pt]{article}
\usepackage[utf8]{inputenc}
\usepackage{graphicx} %for å inkludere grafikk
\usepackage{verbatim} %for å inkludere filer med tegn LaTeX ikke liker
\usepackage{tabularx}
\usepackage{amsmath}
\usepackage{float}
\usepackage{color}
\usepackage{listings}
\usepackage{hyperref}
\lstset{language=c++}
\lstset{basicstyle=\small}
\lstset{backgroundcolor=\color{white}}
\lstset{frame=single}
\lstset{stringstyle=\ttfamily}
\lstset{keywordstyle=\color{red}\bfseries}
\lstset{commentstyle=\itshape\color{blue}}
\lstset{showspaces=false}
\lstset{showstringspaces=false}
\lstset{showtabs=false}
\lstset{breaklines}
\lstset{postbreak=\raisebox{0ex}[0ex][0ex]{\ensuremath{\color{red}\hookrightarrow\space}}}


\title{FYS3150 - Computational Physics\\\vspace{2mm} \Large{Project 3}}
\author{\large Richard Andr\'e Fauli\\ Dorthea Gjestvang\\ Even Marius Nordhagen}
\date{\today}
\begin{document}

\maketitle

\begin{abstract}
\end{abstract}
\begin{itemize}
\item Github repository containing programs and results are in: \url{https://github.com/richaraf/Comphys_projects/tree/master/Project_3}
\end{itemize}
\section{Introduction}
\section{Theory}
In this project we are simulating the planet orbits of the solar system by using Newton's laws of motion. Newton's second law states that the total force on an object with mass $m$ is given by
\begin{equation}
\Sigma\vec{F}=m\vec{a}
\label{eq:N2L}
\end{equation}
where $\Sigma \vec{F}$ is the sum of the forces on the object and $\vec{a}$ is the acceleration. In our case we are going to use this reversed, with finding the acceleration when we already know the force on an object and the mass of an object. Since we are going to deal with long distances, heavy objects and high velocities, we will use astronomical units such as average distance between Earth and the sun, AU, (1AU $\approx1.5\cdot10^{11}$m), Solar mass $M_\odot$ ($1M_{\odot}\approx2\cdot10^{30}$ kg) and velocity AU/$yr$, while the time has unit years, $yr$. The constants are taken from the Project intructions (reference \cite {Project_text}). In space we do not have any friction, so all forces come from gravitation between planets, stars and other objects. Newton's universal law of gravitation between two objects is given by
\begin{equation}
\vec{F}_G=-G\frac{m_1\cdot m_2}{r^2}\hat{r}
\label{eq:GravitationalForce}
\end{equation}
where $G$ is the gravitational constant, $m_1$ and $m_2$ are the masses of the objects and $r$ is the distance between them. Since we are using astronomical units, this gives the value $G = 4\pi^2 M_{\odot} ^{-1} AU^3 yr^{-2}$ \cite{Project_text} for the gravitational constant. The absolute gravitational force between two objects is therefore
\begin{equation}
F_G=-G\frac{m_1\cdot m_2}{r^2}
\label{eq:absGravitationalForce}
\end{equation}
\subsection{Two-body System}
Initially we are studying the two-body problem with the sun fixed to origin and with Earth orbiting the sun. This is not fully correct, since the size of the force on the sun is the same as the size of the force on Earth (Newton's third law). Anyway this is still a good assumption because the mass of Sun is much larger than that of Earth, so the affection from Earth on the sun is negligible. The Earth's orbit around the sun is co-planar (will be two dimensional), so we are decomposing the force in two directions, and from Equation (\ref{eq:N2L}) we obtain
\begin{equation}
a_x=\frac{d^2x}{dt^2}=\frac{F_{G,x}}{M_{Earth}}
\end{equation}
and
\begin{equation}
a_y=\frac{d^2y}{dt^2}=\frac{F_{G,y}}{M_{Earth}}.
\end{equation}
Where $F_{G,x}$ and $F_{G,y}$ are the forces on Earth in respectively x-direction and y-direction. By inserting Equation (\ref{eq:GravitationalForce}) into these equations, we can calculate the total acceleration of Earth:
\begin{equation}
\frac{d^2x}{dt^2}=-G\frac{M_\odot}{r^3}x
\end{equation}
\begin{equation}
\frac{d^2y}{dt^2}=-G\frac{M_\odot}{r^3}y
\end{equation}
We can use the acceleration in compliance with an integration method and find the position and velocity after a time $dt$ using the discrete version of Newton's second law. Examples of such integration methods are the Euler-Cromer method and the Velocity Verlet method. By doing this $N$ times, we can compute the motion for $N\cdot dt$ years. 

<<<<<<< HEAD
In the two-body case the velocity of Earth is set to the analytical velocity which gives a circular orbit. 
=======
In this case Earth's initial velocity is set to the analytical velocity which gives a circular orbit.
 
\subsection{Gravitational theory}
\subsubsection{Circular Orbit}
In the Solar system the orbits of the planets are eliptical, with the Sun in one of the foci[$https://en.wikipedia.org/wiki/Kepler\%27s_laws_of_planetary_motion$]. In the twobody- and threebody parts of this system, we assume circular orbits for the planets we study. To get circular orbits, we have to assume that $M_{\odot} >> M_{planet}$, and that the Sun stands still in the center of mass of the system. \par
\vspace{3mm}

For setting the initial velocity of the planets, we need the orbital velocity of a circular orbit. The centripetal force is the force that makes an object follow a curved path, and its magnitude is given by equation \ref{eq:CentripetalForce}, where $m$ is the mass of object, $v$ is the tangential velocity and $r$ is the radius of the circular path. 

\begin{equation}
     F_c = m \frac{v^2}{r}
     \label{eq:CentripetalForce}
\end{equation}

For a circular orbit, the centripetal force $F_c$ must be equal to the gravitational force, given by \ref{eq:GravitationalForce}, where we use $m = m_1$ and $M =m_2$. We can now calculate the orbital velocity $v_{orb}$ of a circular orbit with radius r:

\begin{equation}
    F_c = F_G \quad \quad m \frac{v_{orb}^2}{r} = \frac{GmM}{r^2} \quad \Rightarrow \quad v_{orb} = \sqrt{\frac{GM}{r}}
    \label{eq:OrbitalVelocity}
\end{equation}

The average distance between the Earth and the Sun is $1 AU$, so the orbital velocity of the Earth in a circular orbit is

\begin{equation*}
    v_{orb} = \sqrt{\frac{GM}{r}} = \sqrt{\frac{ 4\pi^2 M_{\odot} ^{-1} AU^3 yr^{-2} M_{\odot}}{1 AU}} = 2\pi AU/yr 
\end{equation*}

We also need the orbital velocity of Jupiter in a circular orbit. By using equation \ref{eq:OrbitalVelocity} and the average distance between the Sun and Jupiter, $r = 5.2 AU$ [$http://www.universetoday.com/44615/distance-from-the-sun-to-jupiter/$], we find that the velocity of Jupiter in our circular orbit approximation is $\approx 2.755 AU/yr$.

\subsubsection{Escape velocity}
A two body system consists of two objects, object 1 with mass $m_1$ and object 2 with mass $m_2$. The kinetic energy of the object 1 is given by equation \ref{eq:kineticE}, where $v$ is object 1's velocity with respect to the center of mass. The potential energy of object 1 in the gravitational field between the two objects, is given by equation \ref{eq:potE}, where G is the gravitational constant and $|\vec{r}|$ is the distance between the two objects. 

\begin{equation}
    E_k = \frac{1}{2} m_1 v^2
    \label{eq:kineticE}
\end{equation}

\begin{equation}
    E_p = - \frac{G m_1 m_2}{|\vec{r}|}
    \label{eq:potE}
\end{equation}
\par 
\vspace{3mm}

Per definition, the escape velocity of an object is at the point when the object's total energy $E_k + E_p$ is equal to zero [ $https://en.wikipedia.org/wiki/Escape_velocity\#cite_note-1$]. This gives us a way to compute the escape velocity, $v_{esc}$:

\begin{equation*}
    E_k + E_p = 0 \qquad \rightarrow \qquad \frac{1}{2} m v_{esc}^2 - \frac{G m M}{|\vec{r}|} = 0
\end{equation*}

\begin{equation}
     v_{esc}^2 = \frac{2 G M}{|\vec{r}|} \quad \Rightarrow \quad v_{esc} = \sqrt{\frac{2 G M}{|\vec{r}|}}
     \label{esc_v}
\end{equation}

For an object in a distance $|\vec{r}| = 1AU$ from the Sun (as is the case for the Earth), the escape velocity $v_{esc}$ is 

\begin{equation*}
    v_{esc} = \sqrt{\frac{2 G M}{|\vec{r}|}} = \sqrt{\frac{2 * 4\pi^2 M_{\odot} ^{-1} AU^3 yr^{-2} * M_{\odot}}{1 AU}} = \sqrt{8}\pi AU/yr \approx 8.886 AU/yr
\end{equation*}

If we want to check numerically whether a planet is trappet in a gravitational field or escapes, we can implement a test that checks if the total energy of the planet $E = E_k + E_p$ is smaller or bigger than a given tolerance. If the total energy is bigger that the tolerance, the planet is not bound in the gravitational field, and will escape.

>>>>>>> da336694510af236c0720f7342db9fec6ec92521

\subsection{Three-Body System}
Furthermore we have a three-body system where the heaviest planet in the solar system, Jupiter, is set to a circular orbit around the Sun while Earth is still orbiting the sun by a distance 1AU with the sun kept fixed to the origin. For the two-body system we found an analytical solution of the motion, but in this case this is hard, if not even impossible because of the interaction between the planets. Nevertheless we can solve it numerically by using the same equations as for the two-body system. For each "time-step" $dt$ we now need to update the position and velocity for both planets where we also compute the interaction force between them. 

\subsection{Solar System (Many-body System)}
The implementation of the many-body system is very similar to the three-body system, the main difference is that we will have many more forces. Every time we add a new object, we will have $N-1$ new forces act on the system where $N$ is the total number of objects. The total number of forces acting on a many-body system is therefore given by
\begin{equation}
P(N)=\sum_{i=1}^N(i-1)=\sum_{i=0}^{N-1}i=\frac{N(N-1)}{2}.
\end{equation}
We will also look at the real case when all the objects in the solar system are orbiting a barycenter (center of mass). When we implement the model, we do not need equations for all the forces, but we need one equation for the position and velocity in each direction for all the objects. We will therefore need $2\cdot2\cdot8=32$ equations to implement a model for our solar system with 7 planets and the sun in two dimensions. For this we need the masses, distances to Sun, initial positions and initial velocities for all the planets and the sun. The masses and distances to Sun are found in Table (\ref{tab:Masses}).
\begin{table}[H]
\centering
\caption{Masses and distances to sun for all planets in the solar system, given in respectively solar masses and AU.}
\label{tab:Masses}
\begin{tabular}{lcccr}
\hline
Planet  &   & Mass [$M_*$] &    & Distances from Sun [AU] \\
\hline
Mercury 	&	& 1.66051E-07  &    & 0.39    \\
Venus   &   & 2.44827E-06  &    & 0.72    \\
Earth   &   & 3.00329E-06  &    & 1.00    \\
Mars    &   & 3.22774E-05  &    & 1.52    \\
Jupiter &   & 9.54533E-04  &    & 5.20    \\
Saturn 	&	& 2.85797E-04  &    & 9.54    \\
Uranus 	&	& 4.36552E-05  &    & 19.19   \\
Neptun  &	& 5.15000E-05  &    & 30.06   \\
\hline
\end{tabular}
\end{table}
The masses and distances in Table (\ref{tab:Masses}) are taken from the Project instructions \cite{Project_text}, and where we have reduced the number of decimals to 5, although we include 10 decimals in the program. The initial velocities and positions are found in Table ({\ref{tab:Positions}).
\begin{table}[H]
\centering
\caption{Initial positions and velocities for all the planets in the solar system and the sun, given in respectively AU and AU/yr. These data are actual, and downloaded from NASA October 12. 2016.}
\label{tab:Positions}
\begin{tabular}{lrrrrr}
\hline
\multicolumn{3}{r}{Positions [AU]} & \multicolumn{3}{r}{Velocities [AU/yr]} \\
\cline{2-3}
\cline{5-6}
Planet           & x & y &  & x & y \\
\hline
Sun          & 3.57153E-03  & 3.38904E-03  & & -1.97008E-06 & 6.84622E-06  \\
Mercury      & -3.13025E-01 & 1.56078E-01  & & -1.80109E-02 & -2.41438E-02 \\
Venus        & 1.42294E-01  & -7.10557E-01 & & 1.97176E-02  & 3.79469E-03  \\
Earth        & 9.47918E-01  & 3.26107E-01  & & -5.84936E-03 & 1.62170E-02  \\
Mars         & 1.13700E+00  & -7.88667E-01 & & 8.54547E-03  & 1.26763E-02  \\
Jupiter      & -5.43013E+00 & -4.32084E-01 & & 5.12061E-04  & -7.16556E-03 \\
Saturn       & -2.28243E+00 & -9.77097E+00 & & 5.12605E-03  & -1.28636E-03 \\
Uranus 		 & 1.84678E+01  & 7.55105E+00  & & -1.51730E-03 & 3.45720E-03  \\
Neptun 		 & 2.82579E+01  & -9.93123E+00 & & 1.02007E-03  & 2.97988E-03  \\
\hline
\end{tabular}
\end{table}
These are the actual data downloaded from NASA \cite{NASA} October 12. 2016. NB: The data from NASA was given in three dimensions (x, y, z) but we are studying the solar system in two dimensions (x, y), and therefore we have only included the data in x- and y-direction.\par\vspace{3mm}

\section{Method}


\section{Results}
\section{Discussion}
\section{Conclusion}
\section{References}
\begingroup
\renewcommand{\section}[2]{}
\begin{thebibliography}{}
\bibitem{MHJ15}
  Morten Hjorth-Jensen.
  Computational Physics, Lecture Notes Fall 2015.
  Department of Physics, University of Oslo.
  August 2015.
\bibitem{Project_text}
  \url{https://github.com/CompPhysics/ComputationalPhysics/blob/gh-pages/doc/Projects/2016/Project3/pdf/Project3.pdf}
\bibitem{NASA}
  \url{http://ssd.jpl.nasa.gov/horizons.cgi}
\end{thebibliography}
\endgroup
\end{document}
